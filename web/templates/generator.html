{% extends "base.html" %}
{% block content %}
<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-body">
                <h2 class="card-title">Educational Curriculum Generator</h2>
                <p class="card-text">Generate professional curricula with educational standards compliance.</p>
                
                <form method="POST" action="{{ url_for('generate_curriculum') }}" onsubmit="return validateForm()">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="role" class="form-label">Professional Role</label>
                                <select class="form-select" id="role" name="role" required>
                                    {% for role_id, role_info in roles.items() %}
                                    <option value="{{ role_id }}">{{ role_info.title }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label for="eqf_level" class="form-label">EQF Level</label>
                                <select class="form-select" id="eqf_level" name="eqf_level" required>
                                    <option value="5">Level 5</option>
                                    <option value="6" selected>Level 6</option>
                                    <option value="7">Level 7</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label for="ects" class="form-label">ECTS Credits</label>
                                <input type="number" class="form-control" id="ects" name="ects" 
                                       min="0.5" max="180" step="0.5" value="5.0" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Output Formats</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="output_json" name="output_json" checked>
                            <label class="form-check-label" for="output_json">JSON</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="output_html" name="output_html" checked>
                            <label class="form-check-label" for="output_html">HTML</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="output_docx" name="output_docx">
                            <label class="form-check-label" for="output_docx">DOCX (Word Document)</label>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="visual_mapping" name="visual_mapping">
                            <label class="form-check-label" for="visual_mapping">
                                Enable Visual Mapping (slower but more detailed)
                            </label>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-download"></i> Generate Curriculum
                    </button>
                </form>
                
                <hr>
                
                <form method="POST" action="{{ url_for('generate_all_curricula') }}">
                    <h5>Generate All Standard Curricula</h5>
                    <p class="text-muted">Generate all 10 professional curricula (30 files total)</p>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="visual_mapping_all" name="visual_mapping">
                            <label class="form-check-label" for="visual_mapping_all">
                                Enable Visual Mapping
                            </label>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-download"></i> Generate All Curricula
                    </button>
                </form>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Role Information</h5>
                <div id="role-info">
                    {% for role_id, role_info in roles.items() %}
                    <div class="role-detail" data-role="{{ role_id }}" style="display: none;">
                        <h6>{{ role_info.title }}</h6>
                        <p><small>{{ role_info.description }}</small></p>
                        <p><strong>EQF Levels:</strong> {{ role_info.eqf_levels|join(', ') }}</p>
                        <p><strong>ECTS Range:</strong> {{ role_info.ects_range[0] }} - {{ role_info.ects_range[1] }}</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function validateForm() {
    const formats = ['output_json', 'output_html', 'output_docx'];
    const checked = formats.some(id => document.getElementById(id).checked);
    
    if (!checked) {
        alert('Please select at least one output format');
        return false;
    }
    return true;
}

// Show role information
document.getElementById('role').addEventListener('change', function() {
    const selectedRole = this.value;
    document.querySelectorAll('.role-detail').forEach(el => el.style.display = 'none');
    const roleDetail = document.querySelector(`[data-role="${selectedRole}"]`);
    if (roleDetail) roleDetail.style.display = 'block';
});

// Trigger initial role display
document.getElementById('role').dispatchEvent(new Event('change'));
</script>
{% endblock %}